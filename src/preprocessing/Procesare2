import os
import shutil
import random

processed = r"D:\Facultate\RN\docs\processed"

train_dir = r"D:\Facultate\RN\docs\train"
val_dir = r"D:\Facultate\RN\docs\validation"
test_dir = r"D:\Facultate\RN\docs\test"

classes = ["Normal", "Viral Pneumonia"]


def split_class(cls_name):

    os.makedirs(os.path.join(train_dir, cls_name), exist_ok=True)
    os.makedirs(os.path.join(val_dir, cls_name), exist_ok=True)
    os.makedirs(os.path.join(test_dir, cls_name), exist_ok=True)

    src = os.path.join(processed, cls_name)
    images = [f for f in os.listdir(src) if f.endswith(".jpg")]

    random.shuffle(images)

    n = len(images)
    n_train = int(0.70 * n)
    n_val = int(0.15 * n)
    n_test = n - n_train - n_val  

    train_imgs = images[:n_train]
    val_imgs = images[n_train:n_train + n_val]
    test_imgs = images[n_train + n_val:]

    for img in train_imgs:
        shutil.copy(os.path.join(src, img),
                    os.path.join(train_dir, cls_name, img))

    for img in val_imgs:
        shutil.copy(os.path.join(src, img),
                    os.path.join(val_dir, cls_name, img))

    for img in test_imgs:
        shutil.copy(os.path.join(src, img),
                    os.path.join(test_dir, cls_name, img))

    print(f"{cls_name}: {n_train} train, {n_val} val, {n_test} test")


for c in classes:
    split_class(c)

